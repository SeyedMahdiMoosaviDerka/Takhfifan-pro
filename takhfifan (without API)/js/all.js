products = [
  {
    id: 1,
    fname: "استخر یاس پاسداران",
    category: "تفریحی و ورزشی",
    comment: " استخر و ورزش های آبی ",
    location: "پاسداران",
    stock: 4.1,
    sale: 334,
    buy: 18319,
    price: 350000,
    discountPercent: 22,
    pic: "01.png",
  },

  {
    id: 2,
    fname: "استخر آفتاب قدس",
    category: "تفریحی و ورزشی",
    comment: " استخر و ورزش های آبی ",
    location: "شهرک قرب",
    stock: 3.5,
    sale: 250,
    buy: 120000,
    price: 90000,
    discountPercent: 30,
    pic: "02.png",
  },
  {
    id: 3,
    fname: "استخر  سید جلال حسینی",
    category: "تفریحی و ورزشی",
    comment: " استخر و ورزش های آبی ",
    location: "کن",
    stock: 0,
    sale: 0,
    buy: 120000,
    price: 1000,
    discountPercent: 100,
    pic: "03.png",
  },
  {
    id: 4,
    fname: "تله کابین رامسر",
    category: "تفریحی و ورزشی",
    comment: " شهر بازی ",
    location: " رامسر",
    stock: 5,
    sale: 150000,
    buy: 1100,
    price: 180000,
    discountPercent: 30,
    pic: "04.png",
  },
  {
    id: 5,
    fname: " آفتاب قدس",
    category: "تفریحی و ورزشی",
    comment: " شهر بازی ",
    location: "تهران ",
    stock: 1.5,
    sale: 540,
    buy: 40,
    price: 900000,
    discountPercent: 0,
    pic: "05.png",
  },
  {
    id: 6,
    fname: "موچ های قرمز",
    category: "تفریحی و ورزشی",
    comment: " شهر بازی ",
    location: "بابل",
    stock: 1,
    sale: 5000,
    buy: 2,
    price: 60000,
    discountPercent: 99,
    pic: "06.png",
  },
  {
    id: 7,
    fname: "تئاتر تهران",
    category: "تئاتر و هنر",
    comment: " تماشا",
    location: "تهران ",
    stock: 3.5,
    sale: 50,
    buy: 400,
    price: 150000,
    discountPercent: 42,
    pic: "07.png",
  },
  {
    id: 8,
    fname: "سینما ایران",
    category: "تئاتر و هنر",
    comment: "فیلم",
    location: "بابل ",
    stock: 4.5,
    sale: 980,
    buy: 960,
    price: 350000,
    discountPercent: 10,
    pic: "08.png",
  },
  {
    id: 9,
    fname: " آفتاب مشد",
    category: "تفریحی و ورزش ",
    comment: " شهر بازی ",
    location: "آمل ",
    stock: 3.5,
    sale: 410,
    buy: 190,
    price: 120000,
    discountPercent: 30,
    pic: "09.png",
  },
  {
    id: 10,
    fname: "لیزر موی بدن",
    category: "پزشکی و سلامت",
    comment: "لیزر",
    location: "سنندج ",
    stock: 2.5,
    sale: 410,
    buy: 100,
    price: 190000,
    discountPercent: 30,
    pic: "10.png",
  },
  {
    id: 11,
    fname: "لیزر قشنگ",
    category: "پزشکی و سلامت",
    comment: "لیزر",
    location: "سمنان ",
    stock: 1.5,
    sale: 410,
    buy: 10,
    price: 140000,
    discountPercent: 10,
    pic: "11.png",
  },
  {
    id: 12,
    fname: "لیزر اکسیر",
    category: "پزشکی و سلامت",
    comment: "لیزر",
    location: "ساری ",
    stock: 5,
    sale: 2000,
    buy: 1999,
    price: 150000,
    discountPercent: 5,
    pic: "12.png",
  },
  {
    id: 13,
    fname: "شمال گردی با سلکت تور",
    category: "تور و سفر",
    comment: "شمال گردی",
    location: "چالوس ",
    stock: 4.5,
    sale: 420,
    buy: 210,
    price: 200000,
    discountPercent: 20,
    pic: "13.png",
  },
  {
    id: 14,
    fname: "شمال گردی با ممد تور",
    category: "تور و سفر",
    comment: "شمال گردی",
    location: "بابل",
    stock: 2.5,
    sale: 280,
    buy: 90,
    price: 112000,
    discountPercent: 20,
    pic: "14.png",
  },
  {
    id: 15,
    fname: "شمال گردی با قائمشهر تور",
    category: "تور و سفر",
    comment: "شمال گردی",
    location: "قائمشهر",
    stock: 1,
    sale: 1000,
    buy: 199,
    price: 100000,
    discountPercent: 95,
    pic: "15.png",
  },
  {
    id: 16,
    fname: "آژانس ترنج",
    category: "تور و سفر",
    comment: "آنتالیا",
    location: "صادقیه ",
    stock: 1.5,
    sale: 2300,
    buy: 2140,
    price: 1000000,
    discountPercent: 15,
    pic: "16.png",
  },
  {
    id: 17,
    fname: "آمریکا گردی",
    category: "تور و سفر",
    comment: "L.A",
    location: "استاد معین",
    stock: 4.5,
    sale: 1200,
    buy: 1150,
    price: 500000,
    discountPercent: 10,
    pic: "17.png",
  },
  {
    id: 18,
    fname: "آژانس هواپیمایی مهربان",
    category: "تور و سفر",
    comment: "ترکیه",
    location: "سردار جنگل",
    stock: 1,
    sale: 1700,
    buy: 1509,
    price: 15000,
    discountPercent: 15,
    pic: "18.png",
  },
  {
    id: 19,
    fname: "دیجی کالا",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "تهران توکیو",
    stock: 4.5,
    sale: 480,
    buy: 280,
    price: 1000000,
    discountPercent: 1,
    pic: "19.png",
  },
  {
    id: 20,
    fname: "دیجی استایل",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "بابل",
    stock: 1.5,
    sale: 400,
    buy: 250,
    price: 1000000,
    discountPercent: 90,
    pic: "20.png",
  },
  {
    id: 21,
    fname: "نماوا",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "کابل",
    stock: 3,
    sale: 250,
    buy: 200,
    price: 1000000,
    discountPercent: 30,
    pic: "21.png",
  },
  {
    id: 22,
    fname: "خانومی",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "زابل",
    stock: 5,
    sale: 1280,
    buy: 1279,
    price: 1000000,
    discountPercent: 100,
    pic: "22.png",
  },
  {
    id: 23,
    fname: "تکنو لایف",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "ساری",
    stock: 4.5,
    sale: 380,
    buy: 150,
    price: 1000000,
    discountPercent: 1,
    pic: "23.png",
  },
  {
    id: 24,
    fname: "دیجی جت",
    category: "فروشگاه های اینترنتی",
    comment: "سایت گردی",
    location: "واشنگتن",
    stock: 1.5,
    sale: 270,
    buy: 260,
    price: 1000000,
    discountPercent: 50,
    pic: "24.png",
  },
  {
    id: 25,
    fname: "کته باب عمو باقر",
    category: "رستوران و کافه",
    comment: "غذای خوشمزه",
    location: "لس آنجلس",
    stock: 3,
    sale: 170,
    buy: 100,
    price: 300000,
    discountPercent: 50,
    pic: "25.png",
  },
  {
    id: 26,
    fname: "کیی پلا پدربرزرگ",
    category: "رستوران و کافه",
    comment: "غذای خوشمزه",
    location: "جردن",
    stock: 5,
    sale: 1500,
    buy: 1498,
    price: 710000,
    discountPercent: 30,
    pic: "26.png",
  },
  {
    id: 27,
    fname: "گوجه خارشت خوشمزه",
    category: "رستوران و کافه",
    comment: "غذای خوشمزه",
    location: "ساری ",
    stock: 5,
    sale: 420,
    buy: 175,
    price: 150000,
    discountPercent: 10,
    pic: "27.png",
  },
  {
    id: 28,
    fname: "پیتزا فوفو",
    category: "رستوران و کافه",
    comment: "غذای خوشمزه",
    location: "بابل",
    stock: 5,
    sale: 420,
    buy: 175,
    price: 150000,
    discountPercent: 10,
    pic: "28.png",
  },
  {
    id: 29,
    fname: "جفری",
    category: "زیبایی و آرایشی",
    comment: "خمیردندان",
    location: "کابل",
    stock: 2,
    sale: 100,
    buy: 42,
    price: 150000,
    discountPercent: 25,
    pic: "12.png",
  },
  {
    id: 30,
    fname: "موری",
    category: "زیبایی و آرایشی",
    comment: "ژیلت",
    location: "رشت",
    stock: 1,
    sale: 400,
    buy: 145,
    price: 150000,
    discountPercent: 15,
    pic: "09.png",
  },
  {
    id: 31,
    fname: "جفری",
    category: "زیبایی و آرایشی",
    comment: "خوشگل",
    location: "تبریز",
    stock: 4,
    sale: 2500,
    buy: 1455,
    price: 120000,
    discountPercent: 45,
    pic: "07.png",
  },
];

function deres_haken(dataItem) {
  // alert();
  items = document.createElement("div");
  items.className = "items";
  containerList.appendChild(items);

  picture = document.createElement("img");
  picture.className = "itemsPicture";
  picture.src = "images/products/" + dataItem.pic;
  items.appendChild(picture);

  firstItem = document.createElement("div");
  firstItem.className = "itemsContent";
  items.appendChild(firstItem);

  object = document.createElement("p");
  object.className = "object";
  object.innerHTML = dataItem.fname;
  firstItem.appendChild(object);

  gr = document.createElement("p");
  gr.className = "group";
  gr.innerHTML = dataItem.category;
  firstItem.appendChild(gr);

  grf = document.createElement("p");
  grf.className = "groupTypeFirst";
  grf.innerHTML = dataItem.comment;
  firstItem.appendChild(grf);

  firstItemTopChild = document.createElement("div");
  firstItemTopChild.className = "topItems";
  firstItem.appendChild(firstItemTopChild);

  lo = document.createElement("span");
  lo.className = "location";
  lo.innerHTML = dataItem.location;
  firstItemTopChild.appendChild(lo);

  st = document.createElement("span");
  st.className = "stock";
  st.innerHTML = dataItem.stock;
  firstItemTopChild.appendChild(st);

  sa = document.createElement("span");
  sa.className = "sale";
  sa.innerHTML = dataItem.sale;
  firstItemTopChild.appendChild(sa);

  firstItemBottomChild = document.createElement("div");
  firstItemBottomChild.className = "bottomItems";
  firstItem.appendChild(firstItemBottomChild);

  bu = document.createElement("span");
  bu.className = "buy";
  bu.innerHTML = dataItem.buy + "خرید";
  firstItemBottomChild.appendChild(bu);

  pr = document.createElement("span");
  pr.className = "price";
  pr.innerHTML = dataItem.price;
  firstItemBottomChild.appendChild(pr);

  dc = document.createElement("span");
  dc.className = "discount";

  price = dataItem.price;
  off = dataItem.discountPercent / 100;

  priceWithOff = price - price * off;
  dataItem.priceWithOff = priceWithOff;

  dc.innerHTML = priceWithOff + "تومان";
  firstItemBottomChild.appendChild(dc);

  dcp = document.createElement("span");
  dcp.className = "discountPercent";
  dcp.innerHTML = dataItem.discountPercent + "%";
  firstItemBottomChild.appendChild(dcp);

  if (dataItem.discountPercent == 0) {
    pr.style.display = "none";
    dcp.style.display = "none";
    bu.style.width = "65%";
  }

  property = document.createElement("a");
  property.className = "property";
  property.innerHTML = "افزودن به سبد خرید";
  firstItemBottomChild.appendChild(property);

  curEL = products.find((el) => {
    return el.id == dataItem.id;
  });

  property.setAttribute("data-id", curEL.id);

  /* export to basket */

  property.onclick = function () {
    let cid = this.getAttribute("data-id");

    let curEL = products.find((el) => el.id == cid);

    let elId = cid;
    let elName = curEL.fname;
    let elPrice = curEL.price;
    let elPriceWithOff = curEL.priceWithOff;
    let elQuantity = 1;

    let bas = JSON.parse(localStorage.getItem("basket"));

    if (!bas) {
      bas = [];
    }

    basIndex = bas.findIndex((el) => el.elId == cid);

    if (basIndex == -1) {
      bas.push({ elId, elPriceWithOff, elPrice, elQuantity, elName });
    } else {
      bas[basIndex].elQuantity++;
    }

    // alert(elPriceWithOff);

    localStorage.setItem("basket", JSON.stringify(bas));

    openCart();
  };

  // property.onclick = function () {
  //   // alert(dataItem.id);
  //   modal.className = "show";
  //   modal.style.display = "flex";
  //   mainContainer.className = "hide";
  //   // property.setAttribute("data-id", dataItem.id);

  //   let cid = dataItem.id;
  //   // alert(cid);

  //   name.innerHTML = products[curIdIndex].fname;
  //   price.innerHTML = products[curIdIndex].price + "تومان";
  //   off.innerHTML = products[curIdIndex].priceWithOff + "تومان";

  //   da = products[curIdIndex].addDate.toString();
  // };

  // closeModal.onclick = function () {
  //   modal.className = "hide";
  //   mainContainer.className = "main-container";
  // };

  // grid.appendChild(it);
}

function discount() {
  price = dataItem.price;
  off = dataItem.discountPercent / 100;
  priceWithOff = price - price * off;
}

function fill_containerList(jsonData) {
  containerList.innerHTML = "";
  for (i = 0; i < jsonData.length; i++) {
    deres_haken(jsonData[i]);
  }
}

fill_containerList(products);

//  filter

priFrom.oninput = function () {
  priFromOut.innerHTML = priFrom.value;
  filter_data();
};
priTo.oninput = function () {
  priToOut.innerHTML = priTo.value;
  filter_data();
};

cat1.onclick = function () {
  filter_data();
};
cat2.onclick = function () {
  filter_data();
};
cat3.onclick = function () {
  filter_data();
};
cat4.onclick = function () {
  filter_data();
};
cat5.onclick = function () {
  filter_data();
};
cat6.onclick = function () {
  filter_data();
};
cat7.onclick = function () {
  filter_data();
};
cat8.onclick = function () {
  filter_data();
};

cheapSort.onclick = function () {
  filter_data();
};
expensiveSort.onclick = function () {
  filter_data();
};
stockSort.onclick = function () {
  filter_data();
};
priceSort.onclick = function () {
  filter_data();
};
sort.onclick = function () {
  filter_data();
};

function filter_data() {
  // filteredData = [];

  // for (el of products) {
  //   if (el.price >= 500000) {
  //     filteredData.push(el);
  //     containerList.innerHTML += "<br> " + el.fname;
  //   }
  // }

  /* category */

  let allcat = true;
  let catv1 = "";
  let catv2 = "";
  let catv3 = "";
  let catv4 = "";
  let catv5 = "";
  let catv6 = "";
  let catv7 = "";

  if (cat1.checked) {
    catv1 = "رستوران و کافه";
    allcat = false;
  }
  if (cat2.checked) {
    catv2 = "تفریحی و ورزشی";
    allcat = false;
  }
  if (cat3.checked) {
    catv3 = "تئاتر و هنر";
    allcat = false;
  }
  if (cat4.checked) {
    catv4 = "پزشکی و سلامت";
    allcat = false;
  }
  if (cat5.checked) {
    catv5 = "فروشگاه های اینترنتی";
    allcat = false;
  }
  if (cat6.checked) {
    catv6 = "تور و سفر";
    allcat = false;
  }
  if (cat7.checked) {
    catv7 = "زیبایی و آرایشی";
    allcat = false;
  }

  let filteredData = products.filter((el) => {
    return (
      el.price >= priFrom.value &&
      el.price <= priTo.value &&
      (el.category == catv1 ||
        el.category == catv2 ||
        el.category == catv3 ||
        el.category == catv4 ||
        el.category == catv5 ||
        el.category == catv6 ||
        el.category == catv7 ||
        allcat) &&
      el.fname.indexOf(search.value) != -1 &&
      el.fname.indexOf(searchSecond.value) != -1
    );
  });

  if (sort.checked) {
    filteredData = filteredData.sort((a, b) => {
      return a.id - b.id;
    });
  }
  if (cheapSort.checked) {
    filteredData = filteredData.sort((a, b) => {
      return a.price - b.price;
    });
  }
  if (expensiveSort.checked) {
    filteredData = filteredData.sort((a, b) => {
      return b.price - a.price;
    });
  }
  if (stockSort.checked) {
    filteredData = filteredData.sort(function (a, b) {
      return b.stock - a.stock;
    });
  }
  if (priceSort.checked) {
    filteredData = filteredData.sort((a, b) => {
      return b.discountPercent - a.discountPercent;
    });
  }

  fill_containerList(filteredData);
}

search.onkeyup = function () {
  //alert();

  var filteredData = products.filter((el) => {
    return el.fname.indexOf(search.value) != -1;
  });

  fill_containerList(filteredData);
};
searchSecond.onkeyup = function () {
  //alert();

  var filteredData = products.filter((el) => {
    return el.fname.indexOf(searchSecond.value) != -1;
  });

  fill_containerList(filteredData);
};

// addBtn.addEventListener("click", function () {
//   let cid = this.getAttribute("data-id");
//   //alert(cid);

//   let curEl = products.find((el) => el.id == cid);

//   let elId = curEl.id;
//   let elName = curEl.fname;
//   let elPrice = curEl.price;
//   let elImg = curEl.pic;
//   let elQuantity = 1;

//   basket = JSON.parse(localStorage.getItem("basket"));

//   if (!basket) {
//     basket = [];
//   }

//   let basIndex = basket.findIndex((el) => el.elId == cid);

//   if (basIndex !== -1) {
//     basket[basIndex].elQuantity++;
//   } else {
//     basket.push({ elId, elName, elPrice, elImg, elQuantity });
//   }

//   localStorage.setItem("basket", JSON.stringify(basket));
// });
